<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Audio Sample Generator ‚Äî CD</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;background:#0f1724;color:#e6eef8;padding:20px}
    .card{background:#0b1220;border-radius:12px;padding:18px;max-width:1000px;margin:12px auto;box-shadow:0 6px 24px rgba(2,6,23,.6)}
    label{display:block;margin-top:10px;font-size:14px;cursor:help}
    label:hover{color:#58a6ff}
    input[type=range]{width:100%}
    .row{display:flex;gap:12px;align-items:center}
    .col{flex:1}
    button{background:#1f6feb;border:none;padding:10px 14px;border-radius:8px;color:white;cursor:pointer;margin-top:10px;transition:background .2s}
    button:hover{background:#2a7fff}
    button.secondary{background:#334155}
    button.secondary:hover{background:#475569}
    .footer{font-size:13px;color:#9fb0c9;margin-top:8px}
.controls .control-item label.tooltip-box {
  display: block;       /* gi·ªØ label l√† block */
  margin-bottom: 12px;  /* kho·∫£ng c√°ch gi·ªØa c√°c label */
}
    input[type=number]{width:100%;padding:6px;border-radius:6px;border:1px solid #253341;background:#08101a;color:#e6eef8}
    select{padding:6px;border-radius:6px;border:1px solid #253341;background:#08101a;color:#e6eef8;cursor:pointer}
    .lang{float:right}
    .info-icon{display:inline-block;margin-left:6px;color:#58a6ff;cursor:help;font-size:12px}
    .tooltip-box{position:relative;display:inline-block}
    .tooltip-box:hover .tooltip-text{visibility:visible;opacity:1}
    .tooltip-text{visibility:hidden;opacity:0;position:absolute;z-index:1;background:#1c2938;color:#e6eef8;padding:8px 12px;border-radius:6px;font-size:12px;line-height:1.4;width:280px;bottom:125%;left:50%;margin-left:-140px;transition:opacity .3s;box-shadow:0 4px 12px rgba(0,0,0,.4);border:1px solid #334155}
    .tooltip-text::after{content:"";position:absolute;top:100%;left:50%;margin-left:-5px;border-width:5px;border-style:solid;border-color:#1c2938 transparent transparent transparent}
  </style>
</head>
<body>
  <div class="card">
    <div style="display:flex;align-items:center;justify-content:space-between">
      <h2 id="title">Audio Sample Generator</h2>
      <div class="lang">
        <label for="langsel" style="font-size:13px;margin-right:8px;margin-top:0" id="langlabel">Ng√¥n ng·ªØ</label>
        <select id="langsel" aria-label="Select language">
          <option value="vi">Ti·∫øng Vi·ªát</option>
          <option value="en">English</option>
        </select>
      </div>
    </div>

    <p id="desc">T·∫°o v√† t·∫£i xu·ªëng test tone (sine/square/triangle/saw) ho·∫∑c noise.</p>

    <div class="controls">
      <div>
        <label id="waveform_label" class="tooltip-box">
          D·∫°ng s√≥ng
          <span class="info-icon">‚ìò</span>
          <span class="tooltip-text" id="waveform_tooltip"></span>
        </label>
        <select id="waveform">
          <option value="sine" data-tooltip-vi="üéß Sine (Sin) ‚Äî M∆∞·ª£t nh·∫•t, s·∫°ch nh·∫•t. Ch·ªâ c√≥ 1 t·∫ßn s·ªë duy nh·∫•t (kh√¥ng c√≥ h√†i b·∫≠c cao). D√πng nhi·ªÅu nh·∫•t cho test loa/sub. √Çm thanh: '√ôuuuuuuuu' r·∫•t √™m, d·ªÖ nghe, kh√¥ng ch√≥i. ·ª®ng d·ª•ng: Test bass 20Hz, 30Hz, 40Hz; ƒëo ƒë√°p tuy·∫øn t·∫ßn s·ªë; ki·ªÉm tra ƒë·ªô m√©o (THD)." data-tooltip-en="üéß Sine (Sin) ‚Äî Smoothest, cleanest. Single frequency only (no harmonics). Mostly used for testing speakers/subs. Sound: '√ôuuuuuuuu', soft, easy to listen, not harsh. Applications: Bass test 20Hz, 30Hz, 40Hz; frequency response; THD check.">Sine</option>
          <option value="square" data-tooltip-vi="üì¶ Square ‚Äî R·∫•t s·∫Øc, r·∫•t g·∫Øt. Xu·∫•t hi·ªán t·∫ßn s·ªë g·ªëc + c√°c h√†i b·∫≠c l·∫ª (3x, 5x, 7x...). √Çm thanh: ki·ªÉu 'b√≠p/b√≠p/b√≠p', nghe kh√° ch√≥i, ƒë√¥i khi kh√≥ ch·ªãu. ·ª®ng d·ª•ng: Test ph·∫£n h·ªìi t·ªëc ƒë·ªô driver; test loa treble; d√πng trong synth (nh·∫°c ƒëi·ªán t·ª≠ 8-bit)." data-tooltip-en="üì¶ Square ‚Äî Sharp, very 'edgy'. Contains fundamental + odd harmonics (3rd,5th,7th...). Sound: 'beep/beep/beep', quite harsh, sometimes annoying. Applications: Driver speed response; treble speaker test; used in synth (8-bit electronic music).">Square</option>
          <option value="triangle" data-tooltip-vi="üî∫ Triangle ‚Äî M·ªÅm h∆°n square. C√≥ h√†i b·∫≠c l·∫ª nh∆∞ng y·∫øu d·∫ßn nhanh. G·∫ßn gi·ªëng sine nh∆∞ng s·∫Øc h∆°n ch√∫t. √Çm thanh: gi·ªØa sine v√† square, v·∫´n h∆°i g·∫Øt nh∆∞ng kh√¥ng kh√≥ ch·ªãu. ·ª®ng d·ª•ng: Synth nh·∫°c; test h·ªá th·ªëng nh∆∞ng √≠t d√πng h∆°n sine." data-tooltip-en="üî∫ Triangle ‚Äî Softer than square. Contains odd harmonics but weaker. Close to sine but slightly sharper. Sound: between sine and square, slightly harsh but not annoying. Applications: Music synth; system test but less used than sine.">Triangle</option>
          <option value="sawtooth" data-tooltip-vi="üìà Saw/Sawtooth ‚Äî C√≥ m·ªçi b·∫≠c h√†i (r·∫•t gi√†u harmonic). Nghe ƒë·∫ßy v√† cƒÉng. √Çm thanh: ki·ªÉu ti·∫øng xe tƒÉng ho·∫∑c synth lead, d·ªÖ g√¢y m√©o n·∫øu loa/tai kh√¥ng t·ªët. ·ª®ng d·ª•ng: Synth m·∫°nh (EDM, lead, bass); test kh·∫£ nƒÉng x·ª≠ l√Ω harmonic." data-tooltip-en="üìà Saw/Sawtooth ‚Äî Contains all harmonics (very rich). Full and tense sound. Sound: like tank or synth lead, may distort if speakers/headphones are poor. Applications: Powerful synth (EDM, lead, bass); harmonic processing test.">Sawtooth</option>
          <option value="noise" data-tooltip-vi="üîä Noise ‚Äî Nhi·ªÖu tr·∫Øng, d√πng ƒë·ªÉ test t·ªïng th·ªÉ. √Çm thanh: t·∫°p √¢m, d√πng ki·ªÉm tra ƒë√°p tuy·∫øn to√†n d·∫£i. ·ª®ng d·ª•ng: test h·ªá th·ªëng full-range, ƒëo ƒë√°p tuy·∫øn t·∫ßn s·ªë, ki·ªÉm tra thi·∫øt b·ªã." data-tooltip-en="üîä Noise ‚Äî White noise, used for overall system test. Sound: random noise, used for full-range response check. Applications: Full-range system test, frequency response measurement, device check.">Noise</option>
        </select>
      <div style="margin-bottom:12px">
	  </div>
        <label id="freq_label" class="tooltip-box">
          T·∫ßn s·ªë (Hz)
          <span class="info-icon">‚ìò</span>
          <span class="tooltip-text" id="freq_tooltip"></span>
        </label>
        <div style="display:flex;gap:10px;align-items:center">
          <input type="number" id="freq" value="35" min="1" max="20000" step="1" />
          <input type="range" id="freq_slider" value="35" min="1" max="20000" />
        </div>
        <div style="display:flex;justify-content:space-between;align-items:center"><small id="freq_display">35 Hz</small></div>

        <label id="amp_label" class="tooltip-box">
          Bi√™n ƒë·ªô (0.0 - 1.0)
          <span class="info-icon">‚ìò</span>
          <span class="tooltip-text" id="amp_tooltip"></span>
        </label>
        <input type="number" step="0.1" id="amp" value="0.8" min="0" max="1" />

        <label id="dur_label" class="tooltip-box">
          ƒê·ªô d√†i (gi√¢y)
          <span class="info-icon">‚ìò</span>
          <span class="tooltip-text" id="dur_tooltip"></span>
        </label>
        <input type="number" id="duration" value="10" min="1" max="600" />
      </div>

      <div>
        <label id="sr_label" class="tooltip-box">
          T·∫ßn s·ªë m·∫´u (Hz)
          <span class="info-icon">‚ìò</span>
          <span class="tooltip-text" id="sr_tooltip"></span>
        </label>
        <select id="samplerate">
          <option value="8000" data-tooltip-vi="8 kHz ‚Äî Ch·∫•t l∆∞·ª£ng ƒëi·ªán tho·∫°i c∆° b·∫£n. Ch·ªâ ƒë·ªß cho gi·ªçng n√≥i ƒë∆°n gi·∫£n, √¢m thanh m·ªù v√† m√©o. Kh√¥ng d√πng cho √¢m nh·∫°c." data-tooltip-en="8 kHz ‚Äî Basic telephone quality. Only for simple voice, muffled and distorted sound. Not for music.">8 kHz</option>
          <option value="11025" data-tooltip-vi="11.025 kHz ‚Äî Legacy multimedia. D√πng cho game/multimedia c≈© (DOS era). Ch·∫•t l∆∞·ª£ng AM radio, kh√¥ng r√µ. Hi·∫øm khi d√πng ng√†y nay." data-tooltip-en="11.025 kHz ‚Äî Legacy multimedia. Used for old games/multimedia (DOS era). AM radio quality, unclear. Rarely used today.">11.025 kHz</option>
          <option value="16000" data-tooltip-vi="16 kHz ‚Äî VoIP, podcast ch·∫•t l∆∞·ª£ng th·∫•p. ƒê·ªß cho gi·ªçng n√≥i web. √Çm nh·∫°c s·∫Ω thi·∫øu treble v√† chi ti·∫øt. Ti·∫øt ki·ªám bƒÉng th√¥ng." data-tooltip-en="16 kHz ‚Äî VoIP, low-quality podcast. Sufficient for web voice. Music lacks treble and detail. Saves bandwidth.">16 kHz</option>
          <option value="22050" data-tooltip-vi="22.05 kHz ‚Äî Web audio c≈©. Ch·∫•t l∆∞·ª£ng FM radio c≈©. √Çm thanh ·ªïn cho gi·ªçng n√≥i, nh·∫°c h∆°i thi·∫øu. √çt d√πng hi·ªán nay." data-tooltip-en="22.05 kHz ‚Äî Old web audio. Old FM radio quality. Decent for voice, music slightly lacking. Less common now.">22.05 kHz</option>
          <option value="32000" data-tooltip-vi="32 kHz ‚Äî Video broadcast. D√πng cho DAT, NICAM TV audio. Ch·∫•t l∆∞·ª£ng t·ªët cho video, √≠t d√πng cho √¢m nh·∫°c thu·∫ßn. Chu·∫©n broadcast c≈©." data-tooltip-en="32 kHz ‚Äî Video broadcast. Used for DAT, NICAM TV audio. Good for video, less for pure music. Old broadcast standard.">32 kHz</option>
          <option value="44100" data-tooltip-vi="44.1 kHz ‚Äî CD Audio standard. Chu·∫©n CD √¢m nh·∫°c t·ª´ th·∫≠p ni√™n 1980. Ch·∫•t l∆∞·ª£ng t·ªët, ƒë·ªß cho tai ng∆∞·ªùi (20Hz-20kHz). Ph·ªï bi·∫øn nh·∫•t." data-tooltip-en="44.1 kHz ‚Äî CD Audio standard. Music CD standard since 1980s. Good quality, sufficient for human hearing (20Hz-20kHz). Most popular.">44.1 kHz</option>
          <option value="48000" selected data-tooltip-vi="48 kHz ‚≠ê ‚Äî Video/broadcast professional (khuy·∫øn ngh·ªã). Chu·∫©n video, film, broadcast, game. T·ªët h∆°n 44.1kHz ch√∫t, t∆∞∆°ng th√≠ch r·ªông. D√πng cho test loa/sub." data-tooltip-en="48 kHz ‚≠ê ‚Äî Video/broadcast professional (recommended). Standard for video, film, broadcast, games. Slightly better than 44.1kHz, widely compatible. Use for speaker/sub testing.">48 kHz ‚≠ê</option>
          <option value="88200" data-tooltip-vi="88.2 kHz ‚Äî Hi-Res (2x CD). G·∫•p ƒë√¥i 44.1kHz. D√πng mastering chuy√™n nghi·ªáp, chuy·ªÉn ƒë·ªïi xu·ªëng CD d·ªÖ. File l·ªõn g·∫•p ƒë√¥i. Tai ng∆∞·ªùi kh√≥ ph√¢n bi·ªát." data-tooltip-en="88.2 kHz ‚Äî Hi-Res (2x CD). Double 44.1kHz. Professional mastering, easy CD downsampling. File 2x larger. Hard for humans to distinguish.">88.2 kHz</option>
          <option value="96000" data-tooltip-vi="96 kHz ‚Äî Studio recording. Hi-Res audio, chu·∫©n studio cao c·∫•p. Chi ti·∫øt t·ªët h∆°n cho x·ª≠ l√Ω/mixing. File g·∫•p ƒë√¥i 48kHz. L·ª£i √≠ch th·ª±c t·∫ø c√≤n tranh c√£i." data-tooltip-en="96 kHz ‚Äî Studio recording. Hi-Res audio, high-end studio standard. Better detail for processing/mixing. File 2x 48kHz. Real benefits debated.">96 kHz</option>
          <option value="176400" data-tooltip-vi="176.4 kHz ‚Äî Hi-Res extreme (4x CD). G·∫•p 4 l·∫ßn CD. Ch·ªâ d√πng mastering c·ª±c k·ª≥ chuy√™n nghi·ªáp. File r·∫•t l·ªõn (4x). Tai ng∆∞·ªùi KH√îNG nghe ra kh√°c bi·ªát." data-tooltip-en="176.4 kHz ‚Äî Hi-Res extreme (4x CD). 4x CD rate. Only for extremely professional mastering. Very large files (4x). Humans CANNOT hear difference.">176.4 kHz</option>
          <option value="192000" data-tooltip-vi="192 kHz ‚Äî Mastering quality. Cao nh·∫•t cho audio consumer. Ch·ªâ cho mastering engineer chuy√™n s√¢u. File kh·ªïng l·ªì. L√£ng ph√≠ cho test loa th√¥ng th∆∞·ªùng." data-tooltip-en="192 kHz ‚Äî Mastering quality. Highest for consumer audio. Only for deep mastering engineers. Huge files. Wasteful for regular speaker testing.">192 kHz</option>
        </select>

        <label id="channels_label" class="tooltip-box">
          K√™nh
          <span class="info-icon">‚ìò</span>
          <span class="tooltip-text" id="channels_tooltip"></span>
        </label>
        <select id="channels">
          <option value="1">Mono</option>
          <option value="2">Stereo</option>
        </select>

        <label id="bitdepth_label" class="tooltip-box">
          Bit Depth
          <span class="info-icon">‚ìò</span>
          <span class="tooltip-text" id="bitdepth_tooltip"></span>
        </label>
        <select id="bitdepth">
          <option value="16" selected data-tooltip-vi="16-bit ‚Äî CD Quality. 96 dB dynamic range. ƒê·ªß cho h·∫ßu h·∫øt m·ª•c ƒë√≠ch nghe nh·∫°c, test th√¥ng th∆∞·ªùng. File size nh·ªè nh·∫•t. Tai ng∆∞·ªùi kh√≥ ph√¢n bi·ªát v·ªõi bit cao h∆°n trong ƒëi·ªÅu ki·ªán b√¨nh th∆∞·ªùng." data-tooltip-en="16-bit ‚Äî CD Quality. 96 dB dynamic range. Sufficient for most music listening, regular testing. Smallest file size. Humans struggle to distinguish from higher bits in normal conditions.">16-bit</option>
          <option value="24" data-tooltip-vi="24-bit ‚Äî Professional Studio. 144 dB dynamic range. D√πng cho recording, mixing, mastering chuy√™n nghi·ªáp. File l·ªõn h∆°n 50%. L·ª£i √≠ch ch·ªß y·∫øu trong qu√° tr√¨nh x·ª≠ l√Ω, kh√¥ng ph·∫£i nghe." data-tooltip-en="24-bit ‚Äî Professional Studio. 144 dB dynamic range. Used for professional recording, mixing, mastering. 50% larger files. Benefits mainly in processing, not listening.">24-bit</option>
          <option value="32" data-tooltip-vi="32-bit ‚Äî Mastering/Processing. 192 dB dynamic range. D√πng cho x·ª≠ l√Ω audio chuy√™n s√¢u, mastering. File l·ªõn g·∫•p ƒë√¥i 16-bit. Overkill cho test th√¥ng th∆∞·ªùng. Tai ng∆∞·ªùi KH√îNG th·ªÉ ph√¢n bi·ªát khi nghe." data-tooltip-en="32-bit ‚Äî Mastering/Processing. 192 dB dynamic range. Used for deep audio processing, mastering. 2x larger than 16-bit files. Overkill for regular testing. Humans CANNOT distinguish when listening.">32-bit</option>
          <option value="64" data-tooltip-vi="64-bit Float ‚Äî Extreme Professional. Dynamic range g·∫ßn nh∆∞ v√¥ h·∫°n. Ch·ªâ d√πng trong DAW (Digital Audio Workstation) cho x·ª≠ l√Ω n·ªôi b·ªô. File c·ª±c l·ªõn (4x 16-bit). Ho√†n to√†n kh√¥ng c·∫ßn thi·∫øt cho test ho·∫∑c nghe nh·∫°c. L√£ng ph√≠ t√†i nguy√™n." data-tooltip-en="64-bit Float ‚Äî Extreme Professional. Nearly infinite dynamic range. Only used in DAWs (Digital Audio Workstation) for internal processing. Extremely large files (4x 16-bit). Completely unnecessary for testing or music listening. Waste of resources.">64-bit Float</option>
        </select>

        <label id="norm_label" class="tooltip-box">
          Chu·∫©n ho√° tr∆∞·ªõc khi xu·∫•t?
          <span class="info-icon">‚ìò</span>
          <span class="tooltip-text" id="norm_tooltip"></span>
        </label>
        <select id="normalize">
          <option value="true">Yes</option>
          <option value="false">No</option>
        </select>

        <div style="margin-top:10px">
          <button id="play" class="tooltip-box">
            Ph√°t
            <span class="tooltip-text" id="play_tooltip" style="margin-left:-140px"></span>
          </button>
          <button id="stop" class="secondary tooltip-box">
            D·ª´ng
            <span class="tooltip-text" id="stop_tooltip" style="margin-left:-140px"></span>
          </button>
        </div>
      </div>
    </div>

    <div style="margin-top:14px">
      <h3 style="color:#58a6ff;font-size:15px;margin-bottom:8px" id="preset_title">Frequency Presets</h3>
      
      <div style="margin-bottom:12px">
        <strong style="color:#9fb0c9;font-size:13px" id="bass_label">Bass Range</strong><br>
        <button id="preset20" class="secondary tooltip-box">20 Hz <span class="tooltip-text" id="preset20_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset35" class="secondary tooltip-box">35 Hz <span class="tooltip-text" id="preset35_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset40" class="secondary tooltip-box">40 Hz <span class="tooltip-text" id="preset40_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset60" class="secondary tooltip-box">60 Hz <span class="tooltip-text" id="preset60_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset80" class="secondary tooltip-box">80 Hz <span class="tooltip-text" id="preset80_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset100" class="secondary tooltip-box">100 Hz <span class="tooltip-text" id="preset100_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset125" class="secondary tooltip-box">125 Hz <span class="tooltip-text" id="preset125_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset250" class="secondary tooltip-box">250 Hz <span class="tooltip-text" id="preset250_tooltip" style="margin-left:-140px"></span></button>
      </div>
      
      <div style="margin-bottom:12px">
        <strong style="color:#9fb0c9;font-size:13px" id="mid_label">Midrange</strong><br>
        <button id="preset315" class="secondary tooltip-box">315 Hz <span class="tooltip-text" id="preset315_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset500" class="secondary tooltip-box">500 Hz <span class="tooltip-text" id="preset500_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset630" class="secondary tooltip-box">630 Hz <span class="tooltip-text" id="preset630_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset1000" class="secondary tooltip-box">1 kHz <span class="tooltip-text" id="preset1000_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset1250" class="secondary tooltip-box">1.25 kHz <span class="tooltip-text" id="preset1250_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset2000" class="secondary tooltip-box">2 kHz <span class="tooltip-text" id="preset2000_tooltip" style="margin-left:-140px"></span></button>
      </div>
      
      <div style="margin-bottom:12px">
        <strong style="color:#9fb0c9;font-size:13px" id="treble_label">Treble & Air</strong><br>
        <button id="preset2500" class="secondary tooltip-box">2.5 kHz <span class="tooltip-text" id="preset2500_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset4000" class="secondary tooltip-box">4 kHz <span class="tooltip-text" id="preset4000_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset5000" class="secondary tooltip-box">5 kHz <span class="tooltip-text" id="preset5000_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset8000" class="secondary tooltip-box">8 kHz <span class="tooltip-text" id="preset8000_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset10000" class="secondary tooltip-box">10 kHz <span class="tooltip-text" id="preset10000_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset12500" class="secondary tooltip-box">12.5 kHz <span class="tooltip-text" id="preset12500_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset16000" class="secondary tooltip-box">16 kHz <span class="tooltip-text" id="preset16000_tooltip" style="margin-left:-140px"></span></button>
      </div>
      
      <div style="margin-bottom:12px">
        <strong style="color:#9fb0c9;font-size:13px" id="special_label">Special Tests</strong><br>
        <button id="preset_pinknoise" class="secondary tooltip-box">Pink Noise <span class="tooltip-text" id="preset_pinknoise_tooltip" style="margin-left:-140px"></span></button>
        <button id="preset_whitenoise" class="secondary tooltip-box">White Noise <span class="tooltip-text" id="preset_whitenoise_tooltip" style="margin-left:-140px"></span></button>
      </div>
    </div>

    <div style="margin-top:14px">
      <button id="download" class="tooltip-box">
        Render & T·∫£i xu·ªëng WAV
        <span class="tooltip-text" id="download_tooltip" style="margin-left:-140px"></span>
      </button>
    </div>

    <div class="footer" id="footer">L∆∞u √Ω: tr√¨nh duy·ªát c√≥ th·ªÉ gi·ªõi h·∫°n √¢m l∆∞·ª£ng.</div>
  </div>

  <script>
    const strings = {
      vi: {
        title: 'Audio Sample Generator',
        desc: 'T·∫°o v√† t·∫£i xu·ªëng test tone ho·∫∑c noise.',
        waveform_label: 'D·∫°ng s√≥ng',
        waveform_tooltip: 'Ch·ªçn d·∫°ng s√≥ng √¢m thanh',
        freq_label: 'T·∫ßn s·ªë (Hz)',
        freq_tooltip: 'ƒê·ªô cao/th·∫•p c·ªßa √¢m thanh',
        amp_label: 'Bi√™n ƒë·ªô (0.0 - 1.0)',
        amp_tooltip: '√Çm l∆∞·ª£ng c·ªßa t√≠n hi·ªáu',
        dur_label: 'ƒê·ªô d√†i (gi√¢y)',
        dur_tooltip: 'Th·ªùi gian ph√°t',
        sr_label: 'T·∫ßn s·ªë m·∫´u (Hz)',
        sr_tooltip: 'S·ªë l·∫ßn ghi √¢m m·ªói gi√¢y',
        channels_label: 'K√™nh',
        channels_tooltip: 'Mono ho·∫∑c Stereo',
        bitdepth_label: 'Bit Depth',
        bitdepth_tooltip: 'VI: ƒê·ªô s√¢u bit - s·ªë bit d√πng ƒë·ªÉ l∆∞u m·ªói m·∫´u √¢m thanh. 16-bit: CD quality, ƒë·ªß cho h·∫ßu h·∫øt m·ª•c ƒë√≠ch (96 dB dynamic range). 24-bit: Professional recording, studio (144 dB). 32-bit: Mastering, x·ª≠ l√Ω chuy√™n s√¢u (192 dB). Cao h∆°n = file l·ªõn h∆°n, √≠t noise h∆°n, nh∆∞ng tai ng∆∞·ªùi kh√≥ ph√¢n bi·ªát tr√™n 16-bit.',
        norm_label: 'Chu·∫©n ho√°?',
        norm_tooltip: 'TƒÉng bi√™n ƒë·ªô t·ªëi ƒëa',
        play: 'Ph√°t',
        play_tooltip: 'Ph√°t √¢m thanh',
        stop: 'D·ª´ng',
        stop_tooltip: 'D·ª´ng ph√°t',
        download: 'Render & T·∫£i xu·ªëng WAV',
        download_tooltip: 'T·∫°o file WAV',
        preset_title: 'Preset T·∫ßn S·ªë',
        bass_label: 'D·∫£i Bass',
        mid_label: 'D·∫£i Mid',
        treble_label: 'D·∫£i Treble',
        special_label: 'Test ƒê·∫∑c Bi·ªát',
        preset20_tooltip: '20Hz - Infrasound, test sub c·ª±c m·∫°nh',
        preset35_tooltip: '35Hz - Bass c·ª±c s√¢u, test subwoofer',
        preset40_tooltip: '40Hz - Sub-bass, r·∫°p chi·∫øu phim',
        preset60_tooltip: '60Hz - Bass th·∫•p, EDM, hip-hop',
        preset80_tooltip: '80Hz - Bass punch, kick drum',
        preset100_tooltip: '100Hz - Bass trung, bass guitar',
        preset125_tooltip: '125Hz - Bass warm, acoustic',
        preset250_tooltip: '250Hz - Low-mid, gi·ªçng nam',
        preset315_tooltip: '315Hz - Body, ƒë·ªô d√†y vocal',
        preset500_tooltip: '500Hz - Mid, vocal clarity',
        preset630_tooltip: '630Hz - Vocal fundamental',
        preset1000_tooltip: '1kHz - Reference tone chu·∫©n',
        preset1250_tooltip: '1.25kHz - Articulation, ƒë·ªô r√µ l·ªùi',
        preset2000_tooltip: '2kHz - High-mid, tai nh·∫°y nh·∫•t',
        preset2500_tooltip: '2.5kHz - Presence peak',
        preset4000_tooltip: '4kHz - Treble th·∫•p, consonant',
        preset5000_tooltip: '5kHz - Sibilance, ti·∫øng s',
        preset8000_tooltip: '8kHz - Treble cao, brilliance',
        preset10000_tooltip: '10kHz - Air, sparkle',
        preset12500_tooltip: '12.5kHz - Upper air, shimmer',
        preset16000_tooltip: '16kHz - Gi·ªõi h·∫°n tr√™n tai ng∆∞·ªùi',
        preset_pinknoise_tooltip: 'Pink Noise - Test c√¢n b·∫±ng t·∫ßn s·ªë',
        preset_whitenoise_tooltip: 'White Noise - Burn-in loa',
        footer: 'L∆∞u √Ω: tr√¨nh duy·ªát c√≥ th·ªÉ gi·ªõi h·∫°n √¢m l∆∞·ª£ng.',
        langlabel: 'Ng√¥n ng·ªØ'
      },
      en: {
        title: 'Audio Sample Generator',
        desc: 'Generate and download test tones or noise.',
        waveform_label: 'Waveform',
        waveform_tooltip: 'Select audio waveform',
        freq_label: 'Frequency (Hz)',
        freq_tooltip: 'Pitch/tone height',
        amp_label: 'Amplitude (0.0 - 1.0)',
        amp_tooltip: 'Signal volume',
        dur_label: 'Duration (seconds)',
        dur_tooltip: 'Playback time',
        sr_label: 'Sample rate (Hz)',
        sr_tooltip: 'Samples per second',
        channels_label: 'Channel',
        channels_tooltip: 'Mono or Stereo',
        bitdepth_label: 'Bit Depth',
        bitdepth_tooltip: 'EN: Bit depth - number of bits used to store each audio sample. 16-bit: CD quality, sufficient for most purposes (96 dB dynamic range). 24-bit: Professional recording, studio (144 dB). 32-bit: Mastering, deep processing (192 dB). Higher = larger file, less noise, but humans struggle to distinguish above 16-bit.',
        norm_label: 'Normalize?',
        norm_tooltip: 'Boost to max amplitude',
        play: 'Play',
        play_tooltip: 'Play audio',
        stop: 'Stop',
        stop_tooltip: 'Stop playback',
        download: 'Render & Download WAV',
        download_tooltip: 'Generate WAV file',
        preset_title: 'Frequency Presets',
        bass_label: 'Bass Range',
        mid_label: 'Midrange',
        treble_label: 'Treble & Air',
        special_label: 'Special Tests',
        preset20_tooltip: '20Hz - Infrasound, extreme sub test',
        preset35_tooltip: '35Hz - Deep bass, subwoofer test',
        preset40_tooltip: '40Hz - Sub-bass, cinema',
        preset60_tooltip: '60Hz - Low bass, EDM, hip-hop',
        preset80_tooltip: '80Hz - Bass punch, kick drum',
        preset100_tooltip: '100Hz - Mid-bass, bass guitar',
        preset125_tooltip: '125Hz - Bass warmth, acoustic',
        preset250_tooltip: '250Hz - Low-mid, male vocals',
        preset315_tooltip: '315Hz - Body, vocal thickness',
        preset500_tooltip: '500Hz - Mid, vocal clarity',
        preset630_tooltip: '630Hz - Vocal fundamental',
        preset1000_tooltip: '1kHz - Reference tone standard',
        preset1250_tooltip: '1.25kHz - Articulation, clarity',
        preset2000_tooltip: '2kHz - High-mid, most sensitive',
        preset2500_tooltip: '2.5kHz - Presence peak',
        preset4000_tooltip: '4kHz - Lower treble, consonants',
        preset5000_tooltip: '5kHz - Sibilance, s sounds',
        preset8000_tooltip: '8kHz - Upper treble, brilliance',
        preset10000_tooltip: '10kHz - Air, sparkle',
        preset12500_tooltip: '12.5kHz - Upper air, shimmer',
        preset16000_tooltip: '16kHz - Upper hearing limit',
        preset_pinknoise_tooltip: 'Pink Noise - Frequency balance test',
        preset_whitenoise_tooltip: 'White Noise - Speaker burn-in',
        footer: 'Note: browsers may limit output volume.',
        langlabel: 'Language'
      }
    };

    const langSel = document.getElementById('langsel');
    langSel.addEventListener('change', ()=>{ setLang(langSel.value); });

    function setLang(l){
      const s = strings[l];
      document.getElementById('title').innerText = s.title;
      document.getElementById('desc').innerText = s.desc;
      document.getElementById('waveform_label').childNodes[0].textContent = s.waveform_label + ' ';
      document.getElementById('waveform_tooltip').innerText = s.waveform_tooltip;
      document.getElementById('freq_label').childNodes[0].textContent = s.freq_label + ' ';
      document.getElementById('freq_tooltip').innerText = s.freq_tooltip;
      document.getElementById('amp_label').childNodes[0].textContent = s.amp_label + ' ';
      document.getElementById('amp_tooltip').innerText = s.amp_tooltip;
      document.getElementById('dur_label').childNodes[0].textContent = s.dur_label + ' ';
      document.getElementById('dur_tooltip').innerText = s.dur_tooltip;
      document.getElementById('sr_label').childNodes[0].textContent = s.sr_label + ' ';
      document.getElementById('sr_tooltip').innerText = s.sr_tooltip;
      document.getElementById('channels_label').childNodes[0].textContent = s.channels_label + ' ';
      document.getElementById('channels_tooltip').innerText = s.channels_tooltip;
      document.getElementById('bitdepth_label').childNodes[0].textContent = s.bitdepth_label + ' ';
      document.getElementById('bitdepth_tooltip').innerText = s.bitdepth_tooltip;
      document.getElementById('norm_label').childNodes[0].textContent = s.norm_label + ' ';
      document.getElementById('norm_tooltip').innerText = s.norm_tooltip;
      document.getElementById('play').childNodes[0].textContent = s.play + ' ';
      document.getElementById('play_tooltip').innerText = s.play_tooltip;
      document.getElementById('stop').childNodes[0].textContent = s.stop + ' ';
      document.getElementById('stop_tooltip').innerText = s.stop_tooltip;
      document.getElementById('download').childNodes[0].textContent = s.download + ' ';
      document.getElementById('download_tooltip').innerText = s.download_tooltip;
      
      document.getElementById('preset_title').innerText = s.preset_title;
      document.getElementById('bass_label').innerText = s.bass_label;
      document.getElementById('mid_label').innerText = s.mid_label;
      document.getElementById('treble_label').innerText = s.treble_label;
      document.getElementById('special_label').innerText = s.special_label;
      
      const presets = ['20', '35', '40', '60', '80', '100', '125', '250', '315', '500', '630', '1000', '1250', '2000', '2500', '4000', '5000', '8000', '10000', '12500', '16000'];
      presets.forEach(p => {
        const el = document.getElementById('preset' + p + '_tooltip');
        if(el && s['preset' + p + '_tooltip']) el.innerText = s['preset' + p + '_tooltip'];
      });
      
      if(document.getElementById('preset_pinknoise_tooltip')) {
        document.getElementById('preset_pinknoise_tooltip').innerText = s.preset_pinknoise_tooltip;
      }
      if(document.getElementById('preset_whitenoise_tooltip')) {
        document.getElementById('preset_whitenoise_tooltip').innerText = s.preset_whitenoise_tooltip;
      }
      
      // update waveform tooltips
      const waveOpts = document.querySelectorAll('#waveform option');
      waveOpts.forEach(opt => {
        const vi = opt.getAttribute('data-tooltip-vi') || '';
        const en = opt.getAttribute('data-tooltip-en') || '';
        opt.title = (l==='vi') ? vi : en;
      });
      
      // update samplerate tooltips
      const srOpts = document.querySelectorAll('#samplerate option');
      srOpts.forEach(opt => {
        const vi = opt.getAttribute('data-tooltip-vi') || '';
        const en = opt.getAttribute('data-tooltip-en') || '';
        opt.title = (l==='vi') ? vi : en;
      });
      
      // update bitdepth tooltips
      const bdOpts = document.querySelectorAll('#bitdepth option');
      bdOpts.forEach(opt => {
        const vi = opt.getAttribute('data-tooltip-vi') || '';
        const en = opt.getAttribute('data-tooltip-en') || '';
        opt.title = (l==='vi') ? vi : en;
      });
      
      document.getElementById('footer').innerText = s.footer;
      document.getElementById('langlabel').innerText = s.langlabel;
    }

    setLang(langSel.value);

    const freq = document.getElementById('freq');
    const freqSlider = document.getElementById('freq_slider');
    const freqDisplay = document.getElementById('freq_display');
    
    freq.addEventListener('input', ()=>{ 
      freqSlider.value = freq.value; 
      updateFreqDisplay(freq.value); 
    });
    
    freqSlider.addEventListener('input', ()=>{ 
      freq.value = freqSlider.value; 
      updateFreqDisplay(freqSlider.value); 
    });
    
    function updateFreqDisplay(v){ 
      freqDisplay.innerText = Math.round(v*10)/10 + ' Hz'; 
    }

    let realtimeCtx, osc, gainNode, noiseSource, playing = false;
    const waveformEl = document.getElementById('waveform');
    const ampEl = document.getElementById('amp');
    const durationEl = document.getElementById('duration');
    const srEl = document.getElementById('samplerate');
    const channelsEl = document.getElementById('channels');
    const bitdepthEl = document.getElementById('bitdepth');
    const normalizeEl = document.getElementById('normalize');

    function startRealtime() {
      if (playing) return;
      realtimeCtx = new (window.AudioContext || window.webkitAudioContext)();
      const wave = waveformEl.value;
      const gain = parseFloat(ampEl.value);
      const freqVal = parseFloat(freq.value);

      if (wave === 'noise') {
        const bufferSize = 2 * realtimeCtx.sampleRate;
        const noiseBuffer = realtimeCtx.createBuffer(1, bufferSize, realtimeCtx.sampleRate);
        const output = noiseBuffer.getChannelData(0);
        for (let i = 0; i < bufferSize; i++) output[i] = (Math.random() * 2 - 1) * gain;
        noiseSource = realtimeCtx.createBufferSource();
        noiseSource.buffer = noiseBuffer;
        const loopGain = realtimeCtx.createGain();
        loopGain.gain.value = 1.0;
        noiseSource.connect(loopGain).connect(realtimeCtx.destination);
        noiseSource.loop = true;
        noiseSource.start();
      } else {
        osc = realtimeCtx.createOscillator();
        osc.type = wave;
        osc.frequency.value = freqVal;
        gainNode = realtimeCtx.createGain();
        gainNode.gain.value = gain;
        osc.connect(gainNode).connect(realtimeCtx.destination);
        osc.start();
      }
      playing = true;
    }

    function stopRealtime() {
      if (!playing) return;
      try {
        if (osc) { osc.stop(); osc.disconnect(); osc = null; }
        if (noiseSource) { noiseSource.stop(); noiseSource.disconnect(); noiseSource = null; }
        if (gainNode) { gainNode.disconnect(); gainNode = null; }
        if (realtimeCtx) { realtimeCtx.close(); realtimeCtx = null; }
      } catch(e){console.warn(e)}
      playing = false;
    }

    document.getElementById('play').addEventListener('click', startRealtime);
    document.getElementById('stop').addEventListener('click', stopRealtime);

    const presetConfigs = {
      preset20: [20, 0.9], preset35: [35, 0.9], preset40: [40, 0.9], preset60: [60, 0.8],
      preset80: [80, 0.8], preset100: [100, 0.8], preset125: [125, 0.8], preset250: [250, 0.7],
      preset315: [315, 0.7], preset500: [500, 0.7], preset630: [630, 0.7], preset1000: [1000, 0.7],
      preset1250: [1250, 0.7], preset2000: [2000, 0.6], preset2500: [2500, 0.6], preset4000: [4000, 0.6],
      preset5000: [5000, 0.6], preset8000: [8000, 0.5], preset10000: [10000, 0.5], preset12500: [12500, 0.5],
      preset16000: [16000, 0.5]
    };

    Object.keys(presetConfigs).forEach(id => {
      document.getElementById(id).addEventListener('click', ()=>{
        const [f, a] = presetConfigs[id];
        waveformEl.value = 'sine';
        freq.value = f;
        freqSlider.value = f;
        updateFreqDisplay(f);
        ampEl.value = a;
        durationEl.value = 10;
        srEl.value = 48000;
        channelsEl.value = 1;
      });
    });

    document.getElementById('preset_pinknoise').addEventListener('click', ()=>{ 
      waveformEl.value='noise'; ampEl.value='0.7'; durationEl.value='30'; srEl.value='48000'; channelsEl.value='2'; 
    });
    
    document.getElementById('preset_whitenoise').addEventListener('click', ()=>{ 
      waveformEl.value='noise'; ampEl.value='0.7'; durationEl.value='30'; srEl.value='48000'; channelsEl.value='2'; 
    });

    document.getElementById('download').addEventListener('click', async ()=>{
      const wave = waveformEl.value;
      const freqVal = parseFloat(freq.value);
      const amp = parseFloat(ampEl.value);
      const duration = parseFloat(durationEl.value);
      const sampleRate = parseInt(srEl.value,10);
      const channels = parseInt(channelsEl.value,10);
      const bitDepth = parseInt(bitdepthEl.value,10);
      const doNormalize = normalizeEl.value === 'true';

      const totalSamples = Math.floor(sampleRate * duration);
      const buffers = [];
      for (let c=0;c<channels;c++) buffers.push(new Float32Array(totalSamples));
      for (let i=0;i<totalSamples;i++){
        const t = i / sampleRate;
        let v = 0;
        if (wave === 'noise') v = (Math.random()*2 -1) * amp;
        else {
          const phase = 2 * Math.PI * freqVal * t;
          switch(wave){
            case 'sine': v = Math.sin(phase) * amp; break;
            case 'square': v = (Math.sin(phase) >= 0 ? 1 : -1) * amp; break;
            case 'triangle': v = (2/Math.PI) * Math.asin(Math.sin(phase)) * amp; break;
            case 'sawtooth': v = (2/Math.PI) * (freqVal * Math.PI * (t % (1/freqVal)) - (Math.PI/2)) * amp; break;
            default: v = Math.sin(phase) * amp;
          }
        }
        for (let c=0;c<channels;c++) buffers[c][i] = v;
      }

      const fakeBuffer = { numberOfChannels: channels, length: totalSamples, sampleRate: sampleRate, getChannelData: (ch)=>buffers[ch] };
      const wavBlob = bufferToWavBlob(fakeBuffer, doNormalize, bitDepth);
      triggerDownload(wavBlob, 'test-tone-' + wave + '-' + freqVal + 'Hz-' + bitDepth + 'bit-' + duration + 's.wav');
    });

    function bufferToWavBlob(audioBuffer, normalize, bitDepth){
      bitDepth = bitDepth || 16;
      const numChannels = audioBuffer.numberOfChannels;
      const sampleRate = audioBuffer.sampleRate;
      const length = audioBuffer.length;
      const samples = new Float32Array(length * numChannels);
      
      for (let ch=0; ch<numChannels; ch++){
        const data = audioBuffer.getChannelData(ch);
        for (let i=0;i<length;i++) samples[i * numChannels + ch] = data[i];
      }
      
      if (normalize){ 
        let max = 0; 
        for (let i=0;i<samples.length;i++){ 
          const a = Math.abs(samples[i]); 
          if (a>max) max=a; 
        } 
        if (max>0){ 
          const norm = 1.0/max; 
          for (let i=0;i<samples.length;i++) samples[i]*=norm; 
        } 
      }
      
      const bytesPerSample = bitDepth / 8;
      const blockAlign = numChannels * bytesPerSample;
      const byteRate = sampleRate * blockAlign;
      const dataSize = samples.length * bytesPerSample;
      
      const buffer = new ArrayBuffer(44 + dataSize);
      const view = new DataView(buffer);
      
      writeString(view, 0, 'RIFF'); 
      view.setUint32(4, 36 + dataSize, true); 
      writeString(view, 8, 'WAVE'); 
      writeString(view, 12, 'fmt '); 
      view.setUint32(16, 16, true); 
      view.setUint16(20, 1, true); 
      view.setUint16(22, numChannels, true); 
      view.setUint32(24, sampleRate, true); 
      view.setUint32(28, byteRate, true); 
      view.setUint16(32, blockAlign, true); 
      view.setUint16(34, bitDepth, true); 
      writeString(view, 36, 'data'); 
      view.setUint32(40, dataSize, true);
      
      let offset = 44;
      
      if (bitDepth === 16) {
        for (let i = 0; i < samples.length; i++, offset += 2) { 
          let s = Math.max(-1, Math.min(1, samples[i])); 
          view.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7FFF, true); 
        }
      } else if (bitDepth === 24) {
        for (let i = 0; i < samples.length; i++, offset += 3) {
          let s = Math.max(-1, Math.min(1, samples[i]));
          let val = Math.round(s < 0 ? s * 0x800000 : s * 0x7FFFFF);
          view.setUint8(offset, val & 0xFF);
          view.setUint8(offset + 1, (val >> 8) & 0xFF);
          view.setUint8(offset + 2, (val >> 16) & 0xFF);
        }
      } else if (bitDepth === 32) {
        for (let i = 0; i < samples.length; i++, offset += 4) {
          let s = Math.max(-1, Math.min(1, samples[i]));
          view.setInt32(offset, s < 0 ? s * 0x80000000 : s * 0x7FFFFFFF, true);
        }
      } else if (bitDepth === 64) {
        for (let i = 0; i < samples.length; i++, offset += 8) {
          let s = Math.max(-1, Math.min(1, samples[i]));
          view.setFloat64(offset, s, true);
        }
      }
      
      return new Blob([view], { type: 'audio/wav' });
      
      function writeString(view, offset, string) { 
        for (let i = 0; i < string.length; i++) view.setUint8(offset + i, string.charCodeAt(i)); 
      }
    }

    function triggerDownload(blob, filename){ 
      const url = URL.createObjectURL(blob); 
      const a = document.createElement('a'); 
      a.style.display='none'; 
      a.href = url; 
      a.download = filename; 
      document.body.appendChild(a); 
      a.click(); 
      setTimeout(()=>{ 
        document.body.removeChild(a); 
        URL.revokeObjectURL(url); 
      }, 1500); 
    }

  </script>
</body>
</html>
